### 變數定義
@baseUrl = http://localhost:3002
@contentType = application/json

# ==========================================================
# ① 未登入請求 → 預期被拒絕（401 Unauthorized）
# ==========================================================
GET {{baseUrl}}/api/signup
Accept: {{contentType}}

# 說明：未攜帶 Authorization Header，authMiddleware 應回傳 401。


# ==========================================================
# ② 帳號準備與登入 (取得 Token) 
# ==========================================================

### 2-1. 註冊學員 (確保帳號存在)
POST {{baseUrl}}/auth/signup
Content-Type: {{contentType}}

{
  "email": "student@example.com",
  "password": "student123",
  "role": "student"
}

### 2-2. 學員登入 → 取得 Token (200 OK)
# @name studentLogin
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "student@example.com",
  "password": "student123"
}

### 儲存學員 Token 變數
@studentToken = {{studentLogin.response.body.token}}


### 2-3. 管理員登入 → 取得 Token (200 OK)
# @name adminLogin
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "admin@example.com",
  "password": "adminpassword"
}

### 儲存管理員 Token 變數
@adminToken = {{adminLogin.response.body.token}}


# ==========================================================
# ③ 建立測試資料 (由學員建立)
# ==========================================================
# @name createRecord
POST {{baseUrl}}/api/signup
Content-Type: {{contentType}}
Authorization: Bearer {{studentToken}}

{
  "name": "測試資料",
  "email": "test@example.com",
  "phone": "0900111222"
}

### 取得該筆資料 ID
@targetId = {{createRecord.response.body._id}}


# ==========================================================
# ④ 權限不足操作 → 預期被拒絕（403 Forbidden）
# ==========================================================
### 測試情境：學員嘗試刪除不屬於自己的資料 (或是系統限制只有 Admin 可刪除)
DELETE {{baseUrl}}/api/signup/{{targetId}}
Authorization: Bearer {{studentToken}}

# 說明：若 signup.js 邏輯設定只有擁有者或管理員可刪除，則非法操作應回傳 403。


# ==========================================================
# ⑤ 管理者刪除資料 → 預期成功（200 OK）
# ==========================================================
DELETE {{baseUrl}}/api/signup/{{targetId}}
Authorization: Bearer {{adminToken}}

# 說明：管理者具備最高權限，可跨過 ownerId 限制刪除資料。