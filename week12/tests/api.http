@baseUrl = http://localhost:3001

# ==========================================
# 1. [準備] 註冊帳號
# ==========================================

### 1-1. 註冊「一般學員」 (Student)
# @name signupStudent
POST {{baseUrl}}/auth/signup
Content-Type: application/json

{
  "email": "student@test.com",
  "password": "123",
  "role": "student"
}

### 1-2. 註冊「管理員」 (Admin)
# 注意：你的 signup 程式碼需允許接收 role 參數，否則預設會是 student
POST {{baseUrl}}/auth/signup
Content-Type: application/json

{
  "email": "admin@test.com",
  "password": "123",
  "role": "admin"
}

# ==========================================
# 2. [情境 A] 一般學員的操作測試
# ==========================================

### 2-1. 學員登入 (取得 Token)
# @name loginStudent
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "student@test.com",
  "password": "123"
}

### 變數設定：自動抓取學員 Token
@studentToken = {{loginStudent.response.body.token}}

### 2-2. 學員新增報名資料
# @name createByStudent
POST {{baseUrl}}/api/signup
Content-Type: application/json
Authorization: Bearer {{studentToken}}

{
  "name": "我是學員",
  "email": "student@test.com",
  "phone": "0912345678"
}

### 2-3. 學員查詢資料 (應該只看得到自己剛剛建的那 1 筆)
GET {{baseUrl}}/api/signup
Authorization: Bearer {{studentToken}}

# ==========================================
# 3. [情境 B] 管理員的操作測試
# ==========================================

### 3-1. 管理員登入
# @name loginAdmin
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "admin@test.com",
  "password": "123"
}

### 變數設定：自動抓取管理員 Token
@adminToken = {{loginAdmin.response.body.token}}

### 3-2. 管理員查詢資料 (應該要看到學員建的資料，共 1 筆以上)
GET {{baseUrl}}/api/signup
Authorization: Bearer {{adminToken}}

### 3-3. 管理員刪除學員的資料 (測試權限)
# 注意：這裡的 ID 是來自上面 2-2 學員新增的回傳 ID
DELETE {{baseUrl}}/api/signup/{{createByStudent.response.body.insertedId}}
Authorization: Bearer {{adminToken}}